<!DOCTYPE html>
<html>
<head>
  <title>Interactive Map with Markers</title>
  <style>
    #map {
      height: 400px;
      width: 100%;
    }
  </style>
  <!-- Include Leaflet CSS and JS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
</head>
<body>
  <h1>Water Sources Map</h1>
  <div id="map"></div>

  <script>
    // Initialize the map
    var map = L.map('map').setView([47.3, 9], 8);

    // Add OpenStreetMap as the base map
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: 'Â© OpenStreetMap contributors'
    }).addTo(map);

    // Function to fetch additional data when marker is clicked
    function fetchAdditionalData(marker) {
      // Fetch location details from OpenStreetMap using Nominatim API
      fetch(`https://nominatim.openstreetmap.org/reverse?lat=${marker.latlng.lat}&lon=${marker.latlng.lng}&format=json`)
        .then(response => response.json())
        .then(openStreetMapData => {
          const locationName = openStreetMapData.display_name;
          const latitude = marker.latlng.lat;
          const longitude = marker.latlng.lng;

          // Update the marker's pop-up content
          marker.bindPopup(`<h2>${locationName}</h2>
                            <p><strong>Latitude:</strong> ${latitude}</p>
                            <p><strong>Longitude:</strong> ${longitude}</p>`).openPopup();
        })
        .catch(error => {
          console.error('Error fetching OpenStreetMap data:', error);
        });
    }

    // Sample marker data (you can replace this with your fetched data)
    var markerData = { lat: 47.3, lng: 9, name: 'Sample Water Source' };

    // Create marker for the sample data
    var marker = L.marker([parseFloat(markerData.lat), parseFloat(markerData.lng)]).addTo(map);

    // Fetch additional data and update pop-up when marker is clicked
    marker.on('click', function(event) {
      fetchAdditionalData(event.target);
    });
  </script>
</body>
</html>
